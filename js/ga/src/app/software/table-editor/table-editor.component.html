<div class="tableGrid" *ngIf = "_visible">
    <div name = "clickArea" class = "tableControlPanel">
        <div style = "height:30px; float:left; padding: 4px; padding-top:0px; margin-right:5px; width: 200px; text-overflow: ellipsis; overflow: hidden; white-space: nowrap;" 
            title="{{nameTable}}">
            {{nameTable}}
            <div style="position:absolute; top:24px; width:170px; height:6px; left:0px; border-radius:3px;" class = "substrate">
                <div style="position:absolute; top:0px; height:6px; left:0px; border-radius:3px;" 
                    [style.width] = "control.state + '%'"
                    [class.tableCellStateGreen] = "control.state == 100"
                    [class.tableCellStateYellow] = "control.state >= 50 && control.state < 100"
                    [class.tableCellStateRed] = "control.state < 50">
                </div>
                <div style="position:absolute; right:-25px; top: -4px; font-size: 11px; font-weight: bold;" class = "TableCreatorHeadColor">{{control.state + '%'}}</div>
            </div>
        </div>
        <button class = "mainButton" title = "Заголовок" (click) = "changeHeader()" [disabled] = "!right.change"><i class="fas fa-heading"></i></button>
        <button class = "mainButton" title = "Экспорт в Excel" (click) = "exportToExcel()" ><i class="fas fa-file-excel"></i></button>
        <button class = "mainButton" title = "Импорт таблицы" (click) = "importFromExcel()" [disabled] = "!right.change"><i class="fas fa-download"></i></button>
        <button class = "mainButton" title = "Добавить строку" (click) = "addRow()" [disabled] = "!right.change"><i class="fas fa-plus"></i></button>
        <button class = "mainButton" (click) = "loadTable()" title = "Обновить"><i class="fas fa-sync-alt"></i></button>
        <select class = "mainSelect"
            style = "margin-left: 2px; height: 32px; cursor:pointer;" 
            [(ngModel)] = "filter.selected"
            (change) = "onFilterChange()">
            <option *ngFor = "let o of filter.list" [value] = "o.id">{{ o.value }}</option>
        </select>
    </div>
    <div #editTableDiv style = "overflow: auto;">
        <app-error-table #editTable 
            [head] = "dataHeader" 
            [data] = "dataTable" 
            (onChange) = "update($event)" 
            [searchCell] = "searchCellId"></app-error-table>
    </div>
    <div>
        <div class = "bottomControlPanel TableCreatorHeadColor">
            <div *ngIf = "control.error" style = "font-size:12px; background-color:#af7e7e; color:white; font-weight:bold;">Таблица не доступна!</div>
            <div *ngIf = "!load && !control.error && dataHeader.length == 0" style = "font-size:12px; background-color:#b8b8b8; color:white; font-weight:bold;">Таблица пуста</div>
            <div *ngIf = "load" style = "font-size:12px;">Загрузка...</div>
            <div *ngIf = "control.id >0" style = "font-size:12px;">id: {{ control.id }}</div>
            <div *ngIf = "control.filter.countHide > 0" style = "font-size:12px;">Показано: {{ control.filter.count - control.filter.countHide}} из {{ control.filter.count }}</div>
        </div>
        <div class = "bottomControlPanel right">
            <div *ngFor = "let login of listLogin" class = "PanelAppColor" style = "font-weight: bold;">{{login}}</div>
            <div *ngIf = "!right.change" style = "float:right; color:#b5e498; font-size:20px;" title = "Режим просмотра"><i class="fas fa-eye"></i></div>
            <div *ngIf = "mode == 'Global'" style = "float:right; color:#b5e498; font-size:20px;" title = "global"><i class="fas fa-cloud"></i></div>
        </div>
    </div>
</div>
<modalwindow #modal></modalwindow>