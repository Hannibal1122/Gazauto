<div #mainContainer style = "overflow:auto;" [style.height] = "height">
    <table class = "errorTable TableCreatorBorderColor" (dragover)="dragoverHandler($event);">  <!--  -->
        <tbody (click) = "change ? editField($event) : null">
            <tr>
                <th class = "TableCreatorHeadColor"></th>
                <th *ngFor = "let head of header; let i = index;" class = "TableCreatorHeadColor TableCreatorHeadBColor" id = "{{ head.value }}">{{ head.name }}</th>
            </tr>
            <tr *ngFor = "let row of listTables; let i = index;">
                <td (contextmenu) = "getContextmenu($event, i, 'row')" class = "TableCreatorHeadColor TableCreatorHeadBColor">{{ i + 1 }}</td>
                <td *ngFor = "let void of header; let j = index;" 
                    id = "{{ row[j].id }}"
                    (contextmenu) = "getContextmenu($event, i, 'cell')"
                    [style.background] = "row[j] == undefined ? '#fafafa' : (row[j].id == searchCellId ? '#e7f5c6' : none)">
                    {{ row[j] != undefined && !row[j].listValue ? row[j].value : "" }}
                    {{ row[j] != undefined && row[j].listValue ? row[j].listValue : "" }}
                    <span *ngIf = "(row[j].type == 'value' || row[j].type == 'tlist')" class = "linkClass linkValueClass">
                        <i class = "fa fa-link"></i>
                    </span>
                    <span *ngIf = "row[j].type == 'table'" class = "linkClass linkValueClass">
                        <i class = "fa fa-table"></i>
                    </span>
                    <span *ngIf = "row[j].type == 'cell'" class = "linkClass linkCellClass" [class.linkErrorClass] = "row[j].value == null">
                        <i class = "fa fa-link"></i>
                    </span>
                    <span *ngIf = "row[j].type == 'file'" class = "linkClass linkValueClass">
                        <i class = "fa fa-file"></i>
                    </span>
                    <span *ngIf = "row[j].eventId" class = "eventClass linkCellClass" (dblclick) = "openEventToExplorer(row[j].eventId)">
                        <i class = "fa fa-bolt"></i>
                    </span>
                    <div style = "position:absolute; pointer-events:none; width:100%; height:100%; top:0px; left:0px;">
                        <div *ngIf = "row[j].state" [style.width] = "row[j].state + '%'" class = "tableStateLoading" 
                            [class.tableCellStateGreen] = "row[j].state == 100"
                            [class.tableCellStateYellow] = "row[j].state >= 50 && row[j].state < 100"
                            [class.tableCellStateRed] = "row[j].state < 50">
                        </div>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>

    <div #mainEditElement style = "position:absolute;" [ngStyle] = "configInput" [hidden] = "!inputProperty.visible">
        <textarea #mainInputElement class = "mainInputStyle TableCreatorInputColor" 
            (blur) = "acceptEditField($event)" 
            [(ngModel)] = "inputProperty.value" 
            (keydown)="downEnter($event)"></textarea>
        <button #mainButtonElement [hidden] = "inputProperty.type != 'table'" 
            style = "position:absolute; right:0px; top: 0px; color:red; cursor:pointer; border:none; background:none; outline: none;"
            (click) = "inputProperty.value = ''; acceptEditField($event);">
            <i class = "fa fa-times-circle"></i>
        </button>
        <select #mainSelectElement 
            [hidden] = "inputProperty.values.length == 0" 
            (blur) = "acceptEditField($event)" 
            (change) = "changeMainSelect()"
            style = "position:absolute; top: 100%; height: 24px; width:100%;" 
            [(ngModel)] = "inputProperty.valueList">
            <ng-container *ngIf = "inputProperty.typeValues == 'object'">
                <option *ngFor = "let option of inputProperty.values" value = "{{ option.id }}">{{ option.value }}</option>
            </ng-container>
            <ng-container *ngIf = "inputProperty.typeValues != 'object'">
                <option *ngFor = "let option of inputProperty.values; let i = index" value = "{{ i }}">{{ option }}</option>
            </ng-container>
        </select>
        <!-- <div class = "mainStatusStyle TableCreatorStateColor" [hidden] = "!inputProperty.visibleState">
            Статус: <input #mainStatusElement type = "number" (blur) = "acceptEditField($event)" style = "width:45px;" step = "10" min = "0" max = "100" [(ngModel)] = "inputProperty.state"> %
            <button #mainButtonRemoveEvent [hidden] = "!inputProperty.eventId" title = "Удалить событие" (blur) = "acceptEditField($event)" (click) = "removeEvent()">
                <span style = "color:#ca4242;">
                    <i class = "fa fa-bolt"></i>
                </span>
            </button>
        </div> -->
        <!-- <div class = "buttonAcceptEditing" title = "сохранить изменения"><i class="fas fa-check"></i></div> -->
    </div>
</div>
<div *ngIf = "inputProperty.visible" class = "TableCreatorHeadColor" style = "position:absolute; bottom:-26px; font-size:12px;">id: {{ inputProperty.id }}</div>
<div class = "createContextMenu" 
    [hidden] = "!createContextMenu.visible || !change" 
    [style.top] = "createContextMenu.top" 
    [style.left] = "createContextMenu.left"
    [style.transform] = "createContextMenu.transform">
    <ng-container *ngIf = "createContextMenu.type == 'row'">
        <div class = "contextMenuList" (click) = "removeRow(createContextMenu.i)">Удалить строку</div>
        <div class = "contextMenuList" (click) = "addRow(-1)">Вставить строку выше</div>
        <div class = "contextMenuList" (click) = "addRow(0)">Вставить строку ниже</div>
    </ng-container>
    <ng-container *ngIf = "createContextMenu.type == 'cell'">
        <button class = "contextMenuList" (click) = "pasteField()" [disabled] = "!rules.paste">Вставить</button>
        <button class = "contextMenuList" (click) = "pasteObject()" [disabled] = "!rules.pasteObject">Вставить объект</button>
        <button class = "contextMenuList" (click) = "copyOrCut('copy')" [disabled] = "!rules.copy">Копировать</button>
        <button class = "contextMenuList" (click) = "copyOrCut('cut')" [disabled] = "!rules.cut">Вырезать</button>
        <div class = "contextMenuList" (click) = "setState(0)">Статус - 0%</div>
        <div class = "contextMenuList" (click) = "setState(10)">Статус - 10%</div>
        <div class = "contextMenuList" (click) = "setState(50)">Статус - 50%</div>
        <div class = "contextMenuList" (click) = "setState(100)">Статус - 100%</div>
        <div *ngIf = "inputProperty.eventId" class = "contextMenuList" (click) = "removeEvent()">Удалить событие</div>
        <div *ngIf = "inputProperty.type == 'cell'" class = "contextMenuList" (click) = "openToExplorer(inputProperty)">Показать в таблице</div>
        <div *ngIf = "inputProperty.type == 'table' || inputProperty.type == 'file' || inputProperty.type == 'tlist'" class = "contextMenuList" (click) = "openToExplorer(inputProperty)">Показать в проводнике</div>
    </ng-container>
</div>